import argparse
import matplotlib.pyplot as plt
from lwcc import LWCC

def main():
    parser = argparse.ArgumentParser(description="Generate density map from image using LWCC.")
    parser.add_argument("image_path", help="Path to the input image")
    parser.add_argument("-o", "--output", default="density_output.png", help="Output filename for the density image")

    args = parser.parse_args()

    # Run LWCC on the image
    count, density = LWCC.get_count(args.image_path, return_density=True, model_name = "DM-Count", model_weights = "SHA")

    # Plot and save density map
    plt.imshow(density)
    plt.axis('off')
    plt.savefig(args.output, bbox_inches='tight', pad_inches=0)
    plt.close()

    print(f"Count: {count}")
    print(f"Density map saved to {args.output}")

if __name__ == "__main__":
    main()

